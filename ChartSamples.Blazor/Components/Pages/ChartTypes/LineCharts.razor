@page "/chart-types/line-charts"

<PageTitle>Line Charts - Chart Samples</PageTitle>

<SampleBase Title="Line Charts"
            Description="This sample demonstrates Line, Spline, StepLine, and FastLine chart types for displaying connected data points."
            CSharpCode="@_csharpCode">
    
    <div class="sample-controls" style="border-bottom: 1px solid #e0e0e0;">
        <div class="control-group">
            <label>Chart Type:</label>
            <select @bind="SelectedLineType" @bind:after="RefreshChart">
                <option value="Line">Line</option>
                <option value="Spline">Spline (Curved)</option>
                <option value="StepLine">Step Line</option>
                <option value="FastLine">Fast Line (Many Points)</option>
            </select>
        </div>
        <div class="control-group">
            <label>Show Markers:</label>
            <input type="checkbox" @bind="ShowMarkers" @bind:after="RefreshChart" />
        </div>
        <div class="control-group">
            <label>Line Width:</label>
            <select @bind="LineWidth" @bind:after="RefreshChart">
                <option value="1">1px</option>
                <option value="2">2px</option>
                <option value="3">3px</option>
                <option value="4">4px</option>
            </select>
        </div>
        <div class="control-group">
            <label>Data Points:</label>
            <select @bind="DataPointCount" @bind:after="RefreshChart">
                <option value="10">10 Points</option>
                <option value="20">20 Points</option>
                <option value="50">50 Points</option>
                <option value="100">100 Points (FastLine)</option>
            </select>
        </div>
        <div class="control-group">
            <label>Show Second Series:</label>
            <input type="checkbox" @bind="ShowSecondSeries" @bind:after="RefreshChart" />
        </div>
    </div>

    <ChartViewer Width="700" Height="400" Configure="@ConfigureChart" />

</SampleBase>

@code {
    private string SelectedLineType { get; set; } = "Line";
    private bool ShowMarkers { get; set; } = true;
    private int LineWidth { get; set; } = 3;
    private int DataPointCount { get; set; } = 10;
    private bool ShowSecondSeries { get; set; } = true;

    private void ConfigureChart(SvgChart chart)
    {
        chart.Title = $"{SelectedLineType} Chart Example";
        chart.ShowLegend = ShowSecondSeries;

        // Disable markers for FastLine with many points
        var effectiveShowMarkers = ShowMarkers && (SelectedLineType != "FastLine" || DataPointCount <= 20);

        // Series 1
        var series1 = new SvgChartSeries("Series 1")
        {
            ChartType = SvgChartType.Line,
            Color = ChartColor.FromArgb(220, 65, 140, 240),
            LineWidth = LineWidth,
            ShowMarkers = effectiveShowMarkers,
            MarkerSize = 8
        };

        var random = new Random(42); // Fixed seed for consistency
        double value1 = 50;
        
        for (int i = 0; i < DataPointCount; i++)
        {
            if (SelectedLineType == "StepLine")
            {
                // Step line looks better with discrete jumps
                value1 = 30 + random.Next(0, 50);
            }
            else
            {
                // Smooth random walk for other types
                value1 += (random.NextDouble() - 0.5) * 15;
                value1 = Math.Max(10, Math.Min(90, value1));
            }
            series1.Points.Add(new SvgDataPoint(i + 1, value1));
        }
        chart.Series.Add(series1);

        // Series 2
        if (ShowSecondSeries)
        {
            var series2 = new SvgChartSeries("Series 2")
            {
                ChartType = SvgChartType.Line,
                Color = ChartColor.FromArgb(220, 224, 64, 10),
                LineWidth = LineWidth,
                ShowMarkers = effectiveShowMarkers,
                MarkerSize = 8
            };

            double value2 = 30;
            for (int i = 0; i < DataPointCount; i++)
            {
                if (SelectedLineType == "StepLine")
                {
                    value2 = 10 + random.Next(0, 40);
                }
                else
                {
                    value2 += (random.NextDouble() - 0.5) * 12;
                    value2 = Math.Max(5, Math.Min(60, value2));
                }
                series2.Points.Add(new SvgDataPoint(i + 1, value2));
            }
            chart.Series.Add(series2);
        }
    }

    private void RefreshChart()
    {
        StateHasChanged();
    }

    private const string _csharpCode = @"// Configure line chart series
chart1.Series[""Series1""].ChartType = SeriesChartType.Line;
chart1.Series[""Series1""].BorderWidth = 3;
chart1.Series[""Series1""].MarkerStyle = MarkerStyle.Circle;
chart1.Series[""Series1""].MarkerSize = 8;

// Change to Spline for curved lines
chart1.Series[""Series1""].ChartType = SeriesChartType.Spline;

// Change to StepLine for step pattern
chart1.Series[""Series1""].ChartType = SeriesChartType.StepLine;

// Use FastLine for large datasets (better performance)
chart1.Series[""Series1""].ChartType = SeriesChartType.FastLine;
// Note: FastLine doesn't support markers

// Populate with random data
Random random = new Random();
for (int i = 0; i < pointCount; i++)
{
    chart1.Series[""Series1""].Points.AddY(random.Next(45, 95));
    chart1.Series[""Series2""].Points.AddY(random.Next(5, 65));
}

// Customize line appearance
chart1.Series[""Series1""].Color = Color.FromArgb(65, 140, 240);
chart1.Series[""Series1""].BorderDashStyle = ChartDashStyle.Solid;
// Options: Solid, Dash, Dot, DashDot, DashDotDot

// Enable/disable markers
chart1.Series[""Series1""].MarkerStyle = MarkerStyle.None;
// Options: None, Square, Circle, Diamond, Triangle, Cross, Star4, Star5, Star6, Star10";
}
